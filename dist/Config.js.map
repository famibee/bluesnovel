{"version":3,"file":"Config.js","sources":["../src/ts/Config.ts"],"sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n\tCopyright (c) 2018-2024 Famibee (famibee.blog38.fc2.com)\n\n\tThis software is released under the MIT License.\n\thttp://opensource.org/licenses/mit-license.php\n** ***** END LICENSE BLOCK ***** */\n\nimport {CmnLib} from './CmnLib';\nimport type {SysBase} from './SysBase';\nimport {ConfigBase, SEARCH_PATH_ARG_EXT, type T_CFG} from './ConfigBase';\n\n\nexport class Config extends ConfigBase {\n\tstatic\tasync\tgenerate(sys: SysBase) {\n\t\tconst c = new Config(sys);\n\t\tconst fn = sys.arg.cur +'prj.json';\n\t\tconst res = await sys.fetch(fn);\n\t\tif (! res.ok) throw Error(res.statusText);\n\n\t\tconst dec = await sys.dec(fn, await res.text());\n\t\tawait c.load(JSON.parse(dec));\n\t\treturn c;\n\t}\n\n\tprotected\tconstructor(override readonly sys: SysBase) {super(sys)}\n\tprotected\toverride\tasync load(oCfg: T_CFG) {\n\t\tawait super.load(oCfg);\n\n\t\tCmnLib.stageW = oCfg.window.width;\n\t\tCmnLib.stageH = oCfg.window.height;\n\t\tCmnLib.debugLog = oCfg.debug.debugLog;\n\t}\n\n\toverride\tsearchPath(fn: string, extptn: SEARCH_PATH_ARG_EXT = SEARCH_PATH_ARG_EXT.DEFAULT): string {\n\t\tif (fn.startsWith('downloads:/')) {\n\t\t\treturn this.sys.path_downloads + fn.slice(11);\n\t\t}\n\t\tif (fn.startsWith('userdata:/')) {\n\t\t\treturn this.sys.path_userdata + 'storage/'+ fn.slice(10);\n\t\t}\n\n\t\treturn super.searchPath(fn, extptn);\n\t}\n\n}\n"],"names":["Config","ConfigBase","sys","c","fn","res","dec","oCfg","CmnLib","extptn","SEARCH_PATH_ARG_EXT"],"mappings":";AAYO,MAAMA,UAAeC,EAAW;AAAA,EAY5B,YAA8BC,GAAc;AAAC,UAAMA,CAAG,GAAxB,KAAA,MAAAA;AAAA,EAAA;AAAA,EAXxC,aAAa,SAASA,GAAc;AAC7B,UAAAC,IAAI,IAAIH,EAAOE,CAAG,GAClBE,IAAKF,EAAI,IAAI,MAAK,YAClBG,IAAM,MAAMH,EAAI,MAAME,CAAE;AAC9B,QAAI,CAAEC,EAAI,GAAU,OAAA,MAAMA,EAAI,UAAU;AAElC,UAAAC,IAAM,MAAMJ,EAAI,IAAIE,GAAI,MAAMC,EAAI,MAAM;AAC9C,iBAAMF,EAAE,KAAK,KAAK,MAAMG,CAAG,CAAC,GACrBH;AAAA,EAAA;AAAA,EAIR,MAAyB,KAAKI,GAAa;AACpC,UAAA,MAAM,KAAKA,CAAI,GAEdC,EAAA,SAASD,EAAK,OAAO,OACrBC,EAAA,SAASD,EAAK,OAAO,QACrBC,EAAA,WAAWD,EAAK,MAAM;AAAA,EAAA;AAAA,EAGrB,WAAWH,GAAYK,IAA8BC,EAAoB,SAAiB;AAC9F,WAAAN,EAAG,WAAW,aAAa,IACvB,KAAK,IAAI,iBAAiBA,EAAG,MAAM,EAAE,IAEzCA,EAAG,WAAW,YAAY,IACtB,KAAK,IAAI,gBAAgB,aAAYA,EAAG,MAAM,EAAE,IAGjD,MAAM,WAAWA,GAAIK,CAAM;AAAA,EAAA;AAGpC;"}